# Тестовое задание на вакансию AQA (JUnit 5 + RestAssured + WireMock + Allure)

## Требования
- Java 17
- Maven 3.9+
- Allure 
- Rest Assured
- WireMock

---
## Описание

- Тестируется REST API приложения
- Внешние зависимости эмулируются через WireMock
- HTTP-вызовы выполняются через единый ApiClient
- Allure используется для пошагового описания сценариев и вложений запросов/ответов

---
## Список тестов

Покрытие включает несколько диагностических тестов для первоначальной оценки поведения сервиса.

| Название                         | Описание                                                                                                                                               | Ожидаемый результат                                                                                                                                                                                                                                                                                                               | Условие |
|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------|
| testLoginWhenAuthOK              | Проверка позитивного сценария авторизации.                                                                                                             | Сервис вернет статус OK (200). В теле ответа "result" = "OK".                                                                                                                                                                                                                                                                     | — |
| testLoginWhenAuthFails_observed  | Проверка негативного сценария авторизации.                                                                                                             | Сервис вернет ошибку 4xx или 500. В теле ответа "result" = "ERROR", а "message" содержит описание причины ошибки.                                                                                                                                                                                                                 | — |
| testLoginWhenAuthFails_strict    | Проверка позитивного сценария авторизации с падением теста.                                                                                            | Сервис вернет ошибку 409. В теле ответа "result" = "ERROR", а "message" содержит описание причины ошибки.                                                                                                                                                                                                                         | — |
| testLogoutRemoveTokenAndBlockAction | Проверка сценария завершения пользовательской сессии. Включает авторизацию, завершение сессии и попытку совершить действие после завершения сессии. | После авторизации сервис вернет статус OK (200), в теле ответа "result" = "OK".<br/>После завершения сессии сервис вернет статус OK (200), в теле ответа "result" = "OK".<br/>При попытке совершить действие после завершения сессии сервис вернет ошибку 4xx. В теле ответа "result" = "ERROR", а "message" содержит описание причины ошибки. | — |
| testActionIfExternalFails        | Проверка поведения при негативном сценарии взаимодействия с внешним сервисом через /doAction                                                           | Сервис вернет ошибку 4xx или 500. В теле ответа "result" = "ERROR", а "message" содержит описание причины ошибки.                                                                                                                                                                                                                 | Авторизация перед ACTION пройдена успешно. |
| testActionIfExternalRespondsOK   | Проверка поведения при позитивном сценарии взаимодействия с внешним сервисом через /doAction                                                           | Сервис вернет статус OK (200). В теле ответа "result" = "OK".                                                                                                                                                                                                                                                                     | Авторизация перед ACTION пройдена успешно. |
| testActionWithoutLogin           | Проверка попытки отправить запрос /doAction без предварительной аутентификации.                                                                        | Сервис вернет ошибку 4xx или 500. В теле ответа "result" = "ERROR", а "message" содержит описание причины ошибки.                                                                                                                                                                                                                 | Авторизация перед ACTION не пройдена. |
| testLoginWithInvalidApiKey       | Проверка попытки авторизоваться с использованием неверного апи-ключа.                                                                                  | Сервис вернет ошибку 4xx или 500. В теле ответа "result" = "ERROR", а "message" содержит описание причины ошибки.                                                                                                                                                                                                                 | Используется заведомо некорректный апи-ключ. |

---


## Команды запуска

Для выполнения тестов используются команды.

| Команда          | Описание                                         |
|------------------|--------------------------------------------------|
| `mvn test`       | Запускает все тесты                              |
| `mvn clean test` | Очищает target и запускает все тесты             |
| `mvn clean test -Dtags=smoke` | Очищает target и запускает smoke-тесты           |
| `mvn clean test -Dgroups=smoke` | Очищает target и запускает диагностические тесты |
| `mvn allure:serve` | Генерирует и открывает в браузере allure-отчет   |

---
